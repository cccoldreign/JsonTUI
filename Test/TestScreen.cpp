#include <gtest/gtest.h> 
#include "JsonRenderer.h"
#include "Table.h"

#include <fstream>
#include <string>
#include <vector>
#include <memory>
#include <iomanip>
#include <sstream>
// #include <regex>
#include <filesystem>

#include <ftxui/component/captured_mouse.hpp>
#include <ftxui/component/component.hpp>
#include <ftxui/component/screen_interactive.hpp>
#include <ftxui/dom/elements.hpp>

#include <nlohmann/json.hpp>

using namespace ftxui;
using json = nlohmann::json;

void SaveAs(const std::string& content, const std::string& filePath) {
    std::ofstream out(filePath);
    size_t i = 0;
    while (i < content.size()) {
        out << "\"";
        while (i < content.size()) {
            unsigned char c = content[i];
            out << "\\x" << std::hex << std::setw(2) << std::setfill('0') << (int)c;
            ++i;
            if (c == '\n') break;
        }
        out << "\"\n";
    }
}

TEST(TestScreen, AnimationChange){
    std::string fileEx = std::__fs::filesystem::path(__FILE__).parent_path().string() + "/../Example/Example.json";
    std::ifstream file(fileEx);
    ASSERT_TRUE(file.is_open()) << "Failed to open file: " << fileEx;
    json j; 
    file >> j;

    ASSERT_FALSE(j.empty()) << "JSON file is empty or invalid.";

    file.close();

    ASSERT_FALSE(file.is_open()) << "Failed to close file: " << fileEx;

    TableJson* table = new TableJson();
    std::unique_ptr<JsonRenderer> renderer(table);

    Screen screen(40,9);
    auto component = renderer->render(j, fileEx);
    Render(screen, component->Render());

    // SaveAsHex(screen.ToString(), "/Users/coldreign/JsonTUI/text.txt");

    EXPECT_EQ(screen.ToString(),
        "\xe2\x95\xad\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xae\x0d\x0a"
        "\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x47\x6c\x6f\x62\x75\x73\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x3e\x20\x68\x6f\x68\x6d\x20\x20\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x3e\x20\x66\x66\x73\x61\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x1b\x5b\x31\x6d\x3e\x20\x22\x73\x61\x64\x22\x20\x1b\x5b\x32\x32\x6d\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x70\x6c\x6f\x74\x65\x72\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x7a\x7a\x7a\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x1b\x5b\x32\x6d\x1b\x5b\x39\x37\x6d\x1b\x5b\x34\x39\x6d\x76\x61\x6c\x75\x65\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x33\x39\x6d\x1b\x5b\x34\x39\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x89\x20\x1b\x5b\x31\x6d\x69\x6e\x74\x65\x67\x65\x72\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x66\x6c\x6f\x61\x74\x20\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x73\x74\x72\x69\x6e\x67\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x95\xb0\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xaf"
    ) << "First";

    component->OnEvent(Event::ArrowRight);
    Render(screen, component->Render());

    EXPECT_EQ(screen.ToString(),
        "\xe2\x95\xad\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xae\x0d\x0a"
        "\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x47\x6c\x6f\x62\x75\x73\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x68\x6f\x68\x6d\x20\x20\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x3e\x20\x66\x66\x73\x61\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x1b\x5b\x31\x6d\x3e\x20\x22\x73\x61\x64\x22\x20\x1b\x5b\x32\x32\x6d\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x70\x6c\x6f\x74\x65\x72\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x7a\x7a\x7a\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x1b\x5b\x32\x6d\x1b\x5b\x39\x37\x6d\x1b\x5b\x34\x39\x6d\x76\x61\x6c\x75\x65\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x33\x39\x6d\x1b\x5b\x34\x39\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x89\x20\x1b\x5b\x31\x6d\x69\x6e\x74\x65\x67\x65\x72\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x66\x6c\x6f\x61\x74\x20\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x73\x74\x72\x69\x6e\x67\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x95\xb0\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xaf"
    ) << "Second";

    component->OnEvent(Event::ArrowRight);
    Render(screen, component->Render());

    EXPECT_EQ(screen.ToString(),
        "\xe2\x95\xad\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xae\x0d\x0a"
        "\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x47\x6c\x6f\x62\x75\x73\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x68\x6f\x68\x6d\x20\x20\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x66\x66\x73\x61\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x20\x1b\x5b\x31\x6d\x3e\x20\x22\x73\x61\x64\x22\x20\x1b\x5b\x32\x32\x6d\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x70\x6c\x6f\x74\x65\x72\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x7a\x7a\x7a\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x1b\x5b\x32\x6d\x1b\x5b\x39\x37\x6d\x1b\x5b\x34\x39\x6d\x76\x61\x6c\x75\x65\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x33\x39\x6d\x1b\x5b\x34\x39\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x89\x20\x1b\x5b\x31\x6d\x69\x6e\x74\x65\x67\x65\x72\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x66\x6c\x6f\x61\x74\x20\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x73\x74\x72\x69\x6e\x67\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x95\xb0\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xaf"
    ) << "Third";

    component->OnEvent(Event::ArrowRight);
    Render(screen, component->Render());

    EXPECT_EQ(screen.ToString(),
        "\xe2\x95\xad\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xae\x0d\x0a"
        "\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x47\x6c\x6f\x62\x75\x73\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x68\x6f\x68\x6d\x20\x20\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x66\x66\x73\x61\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x20\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x22\x73\x61\x64\x22\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x70\x6c\x6f\x74\x65\x72\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x7a\x7a\x7a\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x1b\x5b\x32\x6d\x1b\x5b\x39\x37\x6d\x1b\x5b\x34\x39\x6d\x76\x61\x6c\x75\x65\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x33\x39\x6d\x1b\x5b\x34\x39\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x89\x20\x1b\x5b\x31\x6d\x69\x6e\x74\x65\x67\x65\x72\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x66\x6c\x6f\x61\x74\x20\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x73\x74\x72\x69\x6e\x67\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x95\xb0\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xaf"
    ) << "Four";

    component->OnEvent(Event::ArrowDown);
    Render(screen, component->Render());

    EXPECT_EQ(screen.ToString(),
        "\xe2\x95\xad\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xae\x0d\x0a"
        "\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x47\x6c\x6f\x62\x75\x73\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x68\x6f\x68\x6d\x20\x20\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x66\x66\x73\x61\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x20\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x22\x73\x61\x64\x22\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x70\x6c\x6f\x74\x65\x72\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x7a\x7a\x7a\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x1b\x5b\x32\x6d\x1b\x5b\x37\x6d\x1b\x5b\x39\x37\x6d\x1b\x5b\x34\x39\x6d\x76\x61\x6c\x75\x65\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\x1b\x5b\x33\x39\x6d\x1b\x5b\x34\x39\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x89\x20\x1b\x5b\x31\x6d\x69\x6e\x74\x65\x67\x65\x72\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x66\x6c\x6f\x61\x74\x20\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x73\x74\x72\x69\x6e\x67\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x95\xb0\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xaf"
    ) << "Five";

    component->OnEvent(Event::Character("1"));
    Render(screen, component->Render());

    EXPECT_EQ(screen.ToString(),
        "\xe2\x95\xad\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xae\x0d\x0a"
        "\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x47\x6c\x6f\x62\x75\x73\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x68\x6f\x68\x6d\x20\x20\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x66\x66\x73\x61\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x20\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x22\x73\x61\x64\x22\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x70\x6c\x6f\x74\x65\x72\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x7a\x7a\x7a\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x1b\x5b\x32\x6d\x1b\x5b\x39\x37\x6d\x1b\x5b\x34\x39\x6d\x31\x20\x6c\x75\x65\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x33\x39\x6d\x1b\x5b\x34\x39\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x89\x20\x1b\x5b\x31\x6d\x69\x6e\x74\x65\x67\x65\x72\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x66\x6c\x6f\x61\x74\x20\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x73\x74\x72\x69\x6e\x67\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x95\xb0\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xaf"
    ) << "Six";
    
    component->OnEvent(Event::Return);
    Render(screen, component->Render());

    EXPECT_EQ(screen.ToString(),
        "\xe2\x95\xad\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xac\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xae\x0d\x0a"
        "\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x47\x6c\x6f\x62\x75\x73\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x68\x6f\x68\x6d\x20\x20\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x1b\x5b\x31\x6d\x1b\x5b\x37\x6d\x3e\x20\x66\x66\x73\x61\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x32\x37\x6d\xe2\x94\x82\x20\x1b\x5b\x31\x6d\x3e\x20\x31\x73\x61\x64\x22\x20\x1b\x5b\x32\x32\x6d\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x70\x6c\x6f\x74\x65\x72\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x1b\x5b\x32\x6d\x20\x20\x7a\x7a\x7a\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x1b\x5b\x32\x6d\x1b\x5b\x39\x37\x6d\x1b\x5b\x34\x39\x6d\x76\x61\x6c\x75\x65\x20\x20\x20\x20\x1b\x5b\x32\x32\x6d\x1b\x5b\x33\x39\x6d\x1b\x5b\x34\x39\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xa4\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x89\x20\x1b\x5b\x31\x6d\x69\x6e\x74\x65\x67\x65\x72\x1b\x5b\x32\x32\x6d\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x66\x6c\x6f\x61\x74\x20\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\x20\x20\x20\x20\x20\x20\xe2\x94\x82\x20\xe2\x97\x8b\x20\x73\x74\x72\x69\x6e\x67\x20\xe2\x94\x82\x0d\x0a"
        "\xe2\x95\xb0\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\xb4\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x94\x80\xe2\x95\xaf"
    ) << "Seven";

    file.open("/Users/coldreign/JsonTUI/Example/Example.json");
    file >> j;
    file.close();
    
    EXPECT_EQ(j["Globus"]["hohm"]["ffsa"], 1);

}
